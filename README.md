# Yoga with Carmen
[View the live project here]()

Yoga with Carmen is a website built for the yoga teacher Carmen Ferraro. The website allows Carmen to showcase her work, publish classes, set maximum available spaces, and display them on a calendar. Users can sign up, view, comment, and like posts, book classes, and comment on their reservations. The purpose of the website is mainly informative. It provides an exhaustive description of the disciplines practiced, allowing users who want to start a yoga journey to have a better understanding of the courses.
Yoga with Carmen targets people interested in yoga and would like to start or keep practicing it; it also targets people with physical pain problems due to bad posture and helps them resolve them through exercise.

## FEATURES:

### Navbar
- The fully responsive navigation bar appears on all pages;
- It includes links to the Logo, Home page, About, Classes, Blog, Sign-in, and Sign Up page and is identical on each page to allow for easy navigation.
- When the user is logged in, the navbar also displays a link to Book and Reservations, which are restricted areas;
- This section will allow the user to easily navigate from page to page across all devices without reverting to the previous page via the ‘back’ button;
- When the screen size reduces to the breakpoint, the navbar collapse into a hamburger menu.

### Callout Section
 <img src ="">

- It displays a message that encourages the user to sign up;
- It includes a link to the Sign Up page to facilitate the process.


### Introduction Section
 <img src ="">

- The introduction section will allow the user to have a quick overview of the purpose of the site and the yoga types practiced;
- In this section, the user will see the benefits of this practice. This should motivate the user to participate in the classes.

### Today's Classes Section
 <img src ="">

- This section  is displayed when there is/are a class/es on the current day;
- It shows the class details so that the user can make a booking or have a reminder;
- When there are no classes on the current day, the section doesn't show.

### Quotes Section
 <img src ="">

- This section provides the  user feedback about the course;
- It motivates the user to subscribe and participate in the classes.

### Footer
 <img src ="">

- The footer section includes links to Carmen's social media sites;
- The links will open to a new tab to allow easy navigation for the user;
- The footer is helpful to the user as it encourages them to keep connected via social media;
- This section appears on all pages.

### Yoga Benefits Section
 <img src ="">

- This section explains to the user the additional values yoga can bring to their life.

### My Passion For Yoga Section
<img src ="">

- Describes Carmen's first steps into yoga discipline and the journey that brought her to become a yoga teacher;
- The experience presented in the section gives the user the feel of a human connection since he can now relate to Carmen as a real person.

### Yoga Class Section
<img src ="">

- This section has an image to allow the user to have a visual acknowledgment of the exercises practiced in the class;
- This section has a button that opens a modal whit the full description of what the class involves to allow the user to understand which yoga type suits them best;
- The modal contains a button that redirects the user to the booking page;
- If the user is not signed in, the button in the modal doesn't display.

### Post Section
<img src="">

- This section has an image to allow the user to have a visual acknowledgment of what the post is about;
- It has a title that links to the specific page of the post;
- Under the title is displayed the date when the post was published and the number of likes.

### Post Page Title Section
<img src="">

- This section displays the title of the post on which the user previously clicked;
- Under the title, it displays the username of the publisher and the date when the post was published.

### Post Page Content Sction
<img src="">

- This section displays the content of the post that the user chose.

### Like Section
<img src="">

- This section displays the number of likes that the relevant post received;
- If signed in, the user can click on the heart icon to leave a like and click again to remove it;
- This section adds interactivity to the website and allows to leave effortless feedback to show appreciation;
- If not signed in, the user can only view the likes, and clicking on the icon won't have any effect.

### Messages Section
<img src="">

- This section displays the number of comments that the relevant post received.

### Comments Section
<img src="">

- This section displays the approved comments written by the admin and users, along with the username and date related to them;
- The comments are ordered by date, with the most recent at the top;
- This section allows the user easily follow the conversation.

### Comments Form Section
<img src="">

- This section displays a form that allows the user to leave feedback;
- Through this section, the user can interact with other users;
- Once the comment is submitted, the user receives feedback about the successful submission and the approval status.


### Booking Form Section
<img src="">

- This section displays a form to make a reservation for a class;
- The dropdown menu displays the classes present on the calendar, and the user can choose from them;
- Once the form is submitted, the user receives feedback on whether the booking has been successful or not, and in that case, it explains the reason for the failure.

### Calendar Section
<img src="">

- This section displays a table with the time slots and the days of the current and next week;
- The days row updates automatically so that the current week is always close-up;
- Every time a class is published is displayed on the calendar in the relevant cell;
- This disposition facilitates the view of the classes for a better time planning for the user.

### Reservations Section
<img src="">

- This section displays the classes booked by the logged-in user and the relative details;
- If the user leaves a note about a class, it displays under the relevant reservation;
- Every reservation has a delete button that, when clicked, calls a modal to receive confirmation of deletion;
- This section is a reminder for the user of the booked classes.

### Notes Section
<img src="">

- This section displays notes written by the user;
- Every note is under the reservation it refers to;
- This section is private, so only the logged-in user can access it;
- Next to each note, there is an edit button that links to an edit note page;
- Next to the edit button, there is a delete button that, when clicked, calls a modal to confirm the deletion.

### Add Notes Section
<img src="">

- This section displays a form that allows the user to add a note to a reservation;
- The user can choose the reservation to comment on from a dropdown menu.

### Edit Notes Section
<img src="">

- This section displays a form that allows the user to edit a note;
- The updated note takes the place of the previous one under the relevant reservation.

### Sign In Section
<img src=""> 

- This section allows the user to create a private account through which they can book classes, write notes, like and comment on posts; 
- The section displays a paragraph for users that already have an account, inviting them to click on the sign-in button to redirect them to the sign-in form;
- The section has a form requesting the user's information to create an account;
If the form is not filled correctly, it displays error  messages relative to the issue;
- Once the form is filled up correctly, the submission redirects the user to the home page and shows a success message.

### Login Section
<img src="">

- This section allows the user to sign in to their private account through which they can book classes, write notes, like and comment on posts; 
- The section displays a paragraph for users that don't already have an account, inviting them to click on the sign-up button to redirect them to the sign-up form;
- The section has a form requesting the user's information to login into their account;
- If the form is not filled correctly, it displays error  messages relative to the issue;
- Once the form is filled up correctly, the submission redirects the user to the home page and shows a success message;
- Under the form, the section displays a 'remember me' thick box. If the user selects it, it saves the details for the next visit;
- Under the thick box, there is a 'forgot password?' link, that redirects the user to a form to reset the password.

### Logout Section
<img src="">

- The section requests the user a logout confirmation;
- Once logged out, the user is redirected to the home page and won't be able to access the restricted areas;
- After the logout, a feedback message displays to acknowledge the user about the outcome of the action.

## Future Features
- A mail system that allows the users to receive an email when the admin deletes or updates a class previously booked;
- A mail system that sends a 'free week classes' when a user signs up;
- A feature to display live classes;
- A system to store classes videos and sell them as packages;
- A payment system to buy lessons packages;
- A feature to buy a package and send it as a gift, making sure that only one device can access it.



## Data Model:
<img src="readme-images/chart.png">

## Testing:

- I have conducted the testing of all models, forms, and views HTTPResponses using the Django built-in tool Unittes. From settings.py I commented out the Postgres DATABASE and used instead:
**DATABASES = {**
  **'default': {**
      **'ENGINE': 'django.db.backends.sqlite3',**
      **'NAME': BASE_DIR / 'db.sqlite3',**
  **}**
**}**

### Manual Testing
- I have conducted manual testing using print statements and/or checking the outcomes on the browser. 
The results are described underneath:
<table>
<thead>
<tr>
<th>Action or Event</th>
<th>Expected Result</th>
<th>Successful?<th>
</tr>
</thead>
<tbody>
<tr>
<td>reservations function:</td>
</tr>
<tr>
<td>Reservation.objects.all()</td>
<td>Returns a QuerySet that contains all Reservation objects in the database.</td>
<td>Yes</td>
</tr>
<tr>
<td>note_form = NotesForm()</td>
<td>Returns a form with all option values.</td>
<td>Yes</td>
</tr>
<tr>
<td>note_form.fields["reservation"].queryset = Reservation.objects.filter(
                member=request.user)</td>
<td>Filters the note form field reseravtion to only the logedin user's reservations.</td>
<td>Yes</td>
</tr>
<tr>
<td>if request.method == 'POST':
        note_form = NotesForm(request.POST)</td>
<td>The note form is displayed, and the field's options are limited to only the logged-in users.</td>
<td>Yes</td>
</tr>
<tr>
<td>new_note = note_form.save()</td>
<td>The new note instance is created and displayed.</td>
<td>Yes</td>
</tr>
<tr>
<td>get_days function:</td>
</tr>
<tr>
<td>today = date.today()</td>
<td>It picks today's date.</td>
<td>Yes</td>
</tr>
<tr>
<td>start = today - timedelta(days=today.weekday())</td>
<td>It picks the first day of the current week.</td>
<td>Yes</td>
</tr>
<tr>
<td>end = start + timedelta(days=13)</td>
<td>It picks the last day of the following week.</td>
<td>Yes</td>
</tr>
<td>dates = [start + timedelta(days=i) for i in range((end-start).days+1)]</td>
<td>It returns the range of dates between the first day of this week and the last of the following.</td>
<td>Yes</td>
</tr>
<tr>
<td>no_obsolete_classes function:</td>
</tr>
<tr>
<td>yoga_classes = YogaClass.objects.filter(status=1)</td>
<td>Returns a QuerySet that contains all YogaClass objects with status 1 (published) in the database.</td>
<td>Yes</td>
</tr>
<tr>
<td>for yoga_class in yoga_classes:
            if yoga_class.day < week_days[0]:
                yoga_class.delete()</td>
<td>It deletes classes older than this week.</td>
<td>Yes</td>
</tr>
<tr>
<td>yoga_classes_available_now function:</td>
</tr>
<tr>
<td>yoga_classes_available = []
    for yoga_class in yoga_classes:
        if yoga_class.day >= date.today():
            yoga_classes_available.append(yoga_class)</td>
<td>It pushes in the yoga_classes_available array only the classes from today on.</td>
<td>Yes</td>
</tr>
<tr>
<td>check_double_booking function:</td>
</tr>
<tr>
<td>reservation = get_object_or_404(Reservation, id=reservation_id)</td>
<td>It returns a reservation with a specific id, which in our case, is the new reservation id.</td>
<td>Yes</td>
</tr>
<tr>
<td>yoga_class_user_reservations = Reservation.objects.filter(
        yoga_class_id=reservation.yoga_class_id, member=current_user)</td>
<td>It returns all the reservations of the current user and the same class.</td>
<td>Yes</td>
</tr>
<tr>
<td>To view totals: type 9</td>
<td>Access to total type options: by month or by expense type</td>
<td>Yes</td>
</tr>
<tr>
<td>Type 1</td>
<td>Access to month option</td>
<td>Yes</td>
</tr>
<tr>
<td>Select month number</td>
<td>- Print a message with the total of the expenses for the relevant month;<br>- Request to exit the game or continue with a new operation.</td>
<td>Yes</td>
</tr>
<tr>
<td>Type 2</td>
<td>Access to expense type options</td>
<td>Yes</td>
</tr>
<tr>
<td>Type expense type number</td>
<td>- Print a message with the yearly total of the selected expense type;<br>- Request to exit the game or continue with a new operation.</td>
<td>Yes</td>
</tr>
<tr>
</tbody>
</table>

### Validator Testing:
- PEP8 
No errors were returned when passing through the official [PEP8 validator]();

## Bugs:
- In script.js, when I tried to retrieve elements by the class name "day" and access their values, I was relating to them as if they were a single value, which led to an error. 
I later realized that the request was receiving an HTMLCollection, and to access it I needed to iterate through the elements. Using a for loop fixed the issue.

- After adding the notes form I realized that the reservation field (from which select the reservation the note has to refer to) was presenting too many options. The possible reservations weren't just the logged-in user's reservations but all users. Adding a filter to the queryset of the reservation field fixed the problem.

- When writing the function reduce_available_spaces the available_spaces value of the relevant class was reduced temporarily.
When the function was called again, it was starting from the initial value. Simply saving the class fixed the problem.

## Deployment:
- Log into Heroku;
- On the dashboard, click on **New**;
- Click the **Create new app** button;
- Name your app by typing the chosen name under **App name**;
- Select your region and click the **Create app** button;
- Create a database in ElephantSql.com;
- Log in to ElephantSQL to access your dashboard;
- Click **Create New Instance**;
- Set up your plan by giving your plan a name (the name of the project);
- Select the Tiny Turtle (Free) plan
- You can leave the Tags field blank
- Click on **Select Region** and select a data center near you;
- Click the **Review** button;
- Check your details are correct and then click **Create instance**;
- Return to the ElephantSQL dashboard and click on the database name for this project;
- In the URL section, click the copy icon to copy the database URL;
- In your project workspace, create a file called env.py; 
- Make sure that this file is included in the .gitignore file;
- In the env.py file type **import.os**;
- Set the environment variables: add a blank line, then set a **DATABASE_URL** variable, with the value you just copied from ElephantSQL following this format:**os.environ["DATABASE_URL"]="copied URL from ElephantSQL"**;
- Add a **SECRET_KEY** following this format: **os.environ["SECRET_KEY"] = "my^secret@key"**;
- Make sure you save the file;
- Open up your settings.py file and add the following code below your Path import: **import os**
 **import dj_database_url**
 **if os.path.isfile('env.py'):**
     **import env**
- A little further down, remove the secret key provided by Django;
- Reference the variable in the env.py file, so change your SECRET_KEY variable to the following: **SECRET_KEY = os.environ.get('SECRET_KEY')**;
- Scroll down in your settings file to the database section and comment out the original DATABASES variable;
- Add this code below: **DATABASES = {**
    **'default': dj_database_url.parse(os.environ.get****("DATABASE_URL"))**
 **}**
- Make sure you save your file;
- Run the migration command in your terminal to migrate your database structure to the newly-connected ElephantSQL database:
 **python3 manage.py migrate**;
- Once the migrations have been completed, head back over to your ElephantSQL dashboard, select your database instance and then select the “Browser” tab on the left;
- Click **Table queries** to reveal a dropdown list, you can see your database structure here;
- Add, commit and push your project to GitHub;
- Go back to the Heroku dashboard and open the Settings tab;
- On the menu bar, click on **Settings**;
- In the **Config Vars** section, click on **Reveal Config Vars**;
- In the field for **KEY** enter **DATABASE_URL**;
- In the field for **VALUE** copy in your database URL from ElephantSQL, and click **Add**;
- In the field for **KEY** enter **SECRET_KEY**;
- In the field for **VALUE** copy the secret key that you used in the env.py file, and click **Add**;
- Add another Config Var underneath by entering **PORT** in the **KEY** field, **8000** in the VALUE field, and clicking the **Add** button;
<!-- - Go to cloudinary.com;
- Click on the **Sign Up For Free** button;
- Provide your name, and email address and choose a password;
- For Primary interest, you can choose Programmable Media for image and video API;
- Click **Create Account**;
- Verify your email and you will be brought to the dashboard;
- Click on the **Copy to clipboard** link next to API environment variable;
- go back to your workspace and in the env.py file, add another line at the bottom. **os.environ["CLOUDINARY_URL"] = "value that we just copied"**, removing from the pasted value "CLOUDINARY_URL =" from the beginning;
- Copy this value again;
- In Heroku add another ConfigVar with the **KEY** value **CLAUDINARY_URL** and pasting in the **VALUE** field the copied value;
- Back in the workspace, in the settings.py file, head to the installed apps section and add in the Cloudinary libraries that we installed before by adding **"cloudinary_storage"** just above **"django.contrib.staticfiles"** and then the regular **"cloudinary"** library underneath;
- Scroll down settings.py and under **STATIC_URL** add: **STATICFILES_STORAGE = "cloudinary_storage.storage.StaticHashedCloudinaryStorage"**,
**STATICFILES_DIRS = [os.path.join(BASE_DIR, 'static')]**, 
**STATIC_ROOT = os.path.join(BASE_DIR, 'staticfiles')**
**MEDIA_URL = '/media/'**
**DEFAULT_FILE_STORAGE = 'cloudinary_storage.storage.MediaCloudinaryStorage'**;
- At the top of settings.py, just under **BASE_DIR** add:
**TEMPLATES_DIR = os.path.join(BASE_DIR, 'templates')**;
- Scroll down midway in your settings.py file and change the **DIRS** key in the **TEMPLATES** like so: **'DIRS': [TEMPLATES_DIR],**; -->
-  Add your Heroku hostname into **ALLOWED_HOSTS** in our settings.py file in this format: **ALLOWED_HOSTS = ['hostname', 'localhost']**;
- In the root of your workspace create **Procfile**;
- Inside **Procfile** add the following code: **web: gunicorn projectname.wsgi**
- Save files, add, commit and push your project to GitHub;
- Go back to the Heroku dashboard;
- Scroll up to the main menu bar and click on **Deploy**;
- In the **Deployment method** section, select **GitHub**;
- Click **Connect to GitHub**;
- Enter the name of your repository in the search bar and click **Search**;
- Once your repository it's shown underneath, click on **Connect**;
- Scroll down to the **Manual deploy** section;
- Click on **Deploy branch**;
- Wait until you see the message **Your app was successfully deployed**;
- Click on **View** to make sure your mock terminal is up and running.

## Credit:
- Code Institute's Love sandwiches walkthrough project: it helped to connect API, build the basic structure of my project and deploy it;
- [Ternary operator tutorial](https://www.tutorialspoint.com/ternary-operator-in-python): helped to solve the previously mentioned bug;
- [Grammarly](https://app.grammarly.com/): helped to correct grammar errors.

### Media:
[Lucidchart](https://www.lucidchart.com): used for the diagram in README.md

## Libraries:
[Gspread](://docs.gspread.org)
[Google auth](https://pypi.org/project/google-auth/)